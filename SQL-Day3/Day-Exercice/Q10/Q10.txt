SELECT e.emp_no, e.first_name, e.last_name, e.hire_date, s.salary, t.title, dm.to_date, d.dept_name 
FROM employees e 
JOIN ( 
SELECT emp_no, MAX(salary) AS salary 
FROM salaries 
GROUP BY emp_no
) s ON e.emp_no = s.emp_no 
JOIN titles t ON e.emp_no = t.emp_no 
JOIN dept_manager dm on e.emp_no = dm.emp_no 
JOIN departments d ON dm.dept_no = d.dept_no 
WHERE dm.to_date = '9999-01-01' 
GROUP BY emp_no;